<h1>マイページ</h1>

<p>名前 : <%= @user.name %></p>
<p>メールアドレス : <%= @user.email %></p>
<p>プロフィール : <%= @user.profile %></p>

<% if current_user.id == @user.id %>
  <%= link_to "編集する", edit_user_registration_path %>
<% end %>


<h2>ユーザーの投稿一覧</h2>
<% @user.tweets.each do |t| %>
  <%= t.user.name %>
  <%= t.name %>
  <%= image_tag t.image_url, size: "250x200" if t.image? %>

  <span class="star-rating">
    <span class="star-rating-front" style="width: <%= getPercent(t.overall) %>%;">★★★★★</span>
    <span class="star-rating-back">★★★★★</span>
  </span>

  <p>いいねの数 : <%= t.likes.count %></p>
  <%= link_to "詳細", tweet_path(t.id) %>

  <% if user_signed_in? && t.user_id.present? && current_user.id == t.user_id %>
      <%= link_to "編集する", edit_tweet_path(t) %>
    <p>
      <%= button_to "削除する", tweet_path(t), method: :delete, data: { confirm: "本当に削除しますか？" } %>
    </p>
  <% end %>
<% end %>


<h2>ユーザーがいいねした投稿一覧</h2>
<% @user.liked_tweets.each do |t| %>
  <% if t.user.present? %>
    <%= t.user.name %>
    <%= t.name %>
    <%= image_tag t.image_url, size: "250x200" if t.image? %>

    <span class="star-rating">
      <span class="star-rating-front" style="width: <%= getPercent(t.overall) %>%;">★★★★★</span>
      <span class="star-rating-back">★★★★★</span>
    </span>

    <p>いいねの数 : <%= t.likes.count %></p>
  <% end %>
<% end %>   <!-- ← これが不足していた！！ -->


<%= link_to "Tweet一覧に戻る", tweets_path %>